---

---

<div class="typing-test">
    <div class="text-display" id="sample-text">
        The quick brown fox jumps over the lazy dog. Pack my box with five dozen
        liquor jugs. How vexingly quick daft zebras jump!
    </div>

    <textarea id="typing-area" placeholder="Start typing here..."></textarea>

    <div class="stats-bar">
        <div class="stat">
            <span class="val" id="wpm">0</span>
            <span class="lbl">WPM</span>
        </div>
        <div class="stat">
            <span class="val" id="acc">100%</span>
            <span class="lbl">Accuracy</span>
        </div>
        <div class="stat">
            <span class="val" id="time">0s</span>
            <span class="lbl">Time</span>
        </div>
        <button id="reset-btn" class="btn">Reset</button>
    </div>
</div>

<script>
    const sample = document.getElementById("sample-text");
    const input = document.getElementById("typing-area") as HTMLTextAreaElement;
    const wpmEl = document.getElementById("wpm");
    const accEl = document.getElementById("acc");
    const timeEl = document.getElementById("time");
    const resetEl = document.getElementById("reset-btn");

    const text = sample.innerText.trim();
    let startTime = null;
    let timer = null;
    let ended = false;

    input.addEventListener("input", () => {
        if (ended) return;
        if (!startTime) {
            startTime = Date.now();
            timer = setInterval(update, 100);
        }

        const val = input.value;
        if (val === text) {
            end();
        }
        update();
    });

    function update() {
        if (!startTime) return;
        const now = Date.now();
        const diff = (now - startTime) / 1000 / 60; // minutes

        const val = input.value;
        const words = val.length / 5;
        const wpm = Math.round(words / diff) || 0;

        let errors = 0;
        for (let i = 0; i < val.length; i++) {
            if (val[i] !== text[i]) errors++;
        }

        const acc =
            Math.max(
                0,
                Math.round(((val.length - errors) / val.length) * 100),
            ) || 100;

        wpmEl.textContent = wpm.toString();
        accEl.textContent = acc + "%";
        timeEl.textContent = Math.round((now - startTime) / 1000) + "s";
    }

    function end() {
        clearInterval(timer);
        ended = true;
        input.disabled = true;
        input.classList.add("finished");
    }

    resetEl.addEventListener("click", () => {
        clearInterval(timer);
        startTime = null;
        ended = false;
        input.value = "";
        input.disabled = false;
        input.classList.remove("finished");
        wpmEl.textContent = "0";
        accEl.textContent = "100%";
        timeEl.textContent = "0s";
    });
</script>

<style>
    .typing-test {
        max-width: 700px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }
    .text-display {
        padding: 1.5rem;
        background: var(--c-surface);
        border-radius: 8px;
        border: 1px solid var(--c-border);
        font-size: 1.2rem;
        line-height: 1.6;
        user-select: none;
    }
    textarea {
        width: 100%;
        height: 100px;
        padding: 1rem;
        font-size: 1.2rem;
        border-radius: 8px;
        border: 1px solid var(--c-border);
        font-family: inherit;
    }
    .stats-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--c-surface-alt);
        padding: 1rem;
        border-radius: 8px;
    }
    .stat {
        text-align: center;
    }
    .val {
        display: block;
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--c-primary);
    }
    .lbl {
        font-size: 0.8rem;
        color: var(--c-text-muted);
    }
    .btn {
        padding: 0.5rem 1rem;
        border: none;
        background: var(--c-text-muted);
        color: white;
        border-radius: 4px;
        cursor: pointer;
    }
    .finished {
        border-color: #22c55e;
        background: #f0fdf4;
    }
</style>

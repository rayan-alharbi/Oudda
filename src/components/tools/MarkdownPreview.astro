---

---

<div class="markdown-editor">
    <div class="toolbar-top">
        <button id="download-html" class="btn-tool">ðŸ“„ ØªØ­Ù…ÙŠÙ„ HTML</button>
        <button id="download-pdf" class="btn-tool">ðŸ“‘ ØªØ­Ù…ÙŠÙ„ PDF</button>
    </div>

    <div class="panes-wrapper">
        <div class="editor-pane">
            <div class="toolbar">MD (Ø§Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ Ù‡Ù†Ø§)</div>
            <textarea
                id="md-input"
                placeholder="# Ø¹Ù†ÙˆØ§Ù† Ø±Ø¦ÙŠØ³ÙŠ\n\nÙ†Øµ Ø¹Ø§Ø¯ÙŠ **Ù†Øµ ØºØ§Ù…Ù‚**\n- Ù‚Ø§Ø¦Ù…Ø©"
            ></textarea>
        </div>
        <div class="preview-pane">
            <div class="toolbar">Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</div>
            <div id="md-preview" class="preview-content"></div>
        </div>
    </div>
</div>

<script>
    import { marked } from "marked";
    import html2pdf from "html2pdf.js";

    const input = document.getElementById("md-input") as HTMLTextAreaElement;
    const preview = document.getElementById("md-preview") as HTMLDivElement;
    const dlHtml = document.getElementById(
        "download-html",
    ) as HTMLButtonElement;
    const dlPdf = document.getElementById("download-pdf") as HTMLButtonElement;

    function update() {
        const text = input.value;
        const result = marked.parse(text);
        if (typeof result === "string") {
            preview.innerHTML = result;
        } else {
            result.then((html) => {
                preview.innerHTML = html;
            });
        }
    }

    input.addEventListener("input", update);
    input.value =
        "# Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¹ÙÙ€Ø¯Ù‘Ø© ðŸ‘‹\n\nÙŠÙ…ÙƒÙ†Ùƒ ÙƒØªØ§Ø¨Ø© **Markdown** Ù‡Ù†Ø§ ÙˆØ³ÙŠØªÙ… Ø¹Ø±Ø¶Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø©.\n\n- Ù†Ù‚Ø·Ø© 1\n- Ù†Ù‚Ø·Ø© 2";
    update();

    // Download HTML
    dlHtml?.addEventListener("click", () => {
        const blob = new Blob([preview.innerHTML], { type: "text/html" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "document.html";
        a.click();
        URL.revokeObjectURL(url);
    });

    // Download PDF
    dlPdf?.addEventListener("click", () => {
        const element = preview;
        const opt = {
            margin: 10,
            filename: "document.pdf",
            image: { type: "jpeg" as const, quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: {
                unit: "mm" as const,
                format: "a4" as const,
                orientation: "portrait" as const,
            },
        };
        // @ts-ignore - html2pdf types can be tricky
        html2pdf().set(opt).from(element).save();
    });
</script>

<style>
    .markdown-editor {
        max-width: 1000px;
        margin: 0 auto;
    }
    .toolbar-top {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
        justify-content: flex-end;
    }
    .btn-tool {
        padding: 8px 15px;
        border: 1px solid var(--c-primary);
        background: var(--c-surface);
        color: var(--c-primary);
        border-radius: 4px;
        cursor: pointer;
    }
    .btn-tool:hover {
        background: var(--c-background);
    }

    .panes-wrapper {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-md);
        height: 600px;
    }
    @media (max-width: 768px) {
        .panes-wrapper {
            grid-template-columns: 1fr;
            height: auto;
        }
    }

    .editor-pane,
    .preview-pane {
        display: flex;
        flex-direction: column;
        border: 1px solid var(--c-border);
        border-radius: var(--radius-md);
        overflow: hidden;
        background: var(--c-surface);
    }
    .toolbar {
        background: var(--c-background);
        padding: var(--space-sm);
        font-weight: bold;
        border-bottom: 1px solid var(--c-border);
        text-align: center;
    }
    textarea {
        flex: 1;
        resize: none;
        border: none;
        padding: var(--space-md);
        font-family: monospace;
        font-size: 1rem;
        min-height: 300px;
        outline: none;
    }
    .preview-content {
        flex: 1;
        padding: var(--space-md);
        overflow-y: auto;
        background: white;
    }

    /* Global Styles for Preview Content */
    .preview-content :global(h1) {
        border-bottom: 2px solid var(--c-border);
        padding-bottom: 0.5rem;
    }
    .preview-content :global(blockquote) {
        border-right: 4px solid var(--c-primary);
        margin: 0;
        padding-right: 1rem;
        color: var(--c-text-muted);
    }
    .preview-content :global(code) {
        background: #f1f5f9;
        padding: 0.2rem 0.4rem;
        border-radius: 4px;
        font-family: monospace;
    }
</style>

---

---

<div class="date-converter">
    <div class="tabs">
        <button class="tab-btn active" data-tab="g-to-h">ميلادي ◀ هجري</button>
        <button class="tab-btn" data-tab="h-to-g">هجري ◀ ميلادي</button>
    </div>

    <!-- Gregorian to Hijri Section -->
    <div id="g-to-h" class="tab-content active">
        <div class="form-group">
            <label for="g-date-input">اختر التاريخ الميلادي</label>
            <input type="date" id="g-date-input" class="form-input" />
        </div>

        <div class="result-box">
            <span class="label">التاريخ الهجري المقابل:</span>
            <div id="h-result" class="result-value">-</div>
            <div id="h-result-details" class="result-details"></div>
        </div>
    </div>

    <!-- Hijri to Gregorian Section -->
    <div id="h-to-g" class="tab-content">
        <div class="hijri-inputs">
            <div class="select-wrapper">
                <label>اليوم</label>
                <select id="h-day" class="form-select"></select>
            </div>
            <div class="select-wrapper">
                <label>الشهر</label>
                <select id="h-month" class="form-select"></select>
            </div>
            <div class="select-wrapper">
                <label>السنة</label>
                <input
                    type="number"
                    id="h-year"
                    class="form-input"
                    placeholder="1445"
                    min="1300"
                    max="1500"
                />
            </div>
        </div>

        <button id="convert-h-btn" class="btn-primary">تحويل</button>

        <div class="result-box">
            <span class="label">التاريخ الميلادي المقابل:</span>
            <div id="g-result" class="result-value">-</div>
            <div id="g-result-details" class="result-details"></div>
        </div>
    </div>
</div>

<script>
    import { toHijri, toGregorian } from "hijri-converter";

    // Elements
    const tabs = document.querySelectorAll(".tab-btn");
    const contents = document.querySelectorAll(".tab-content");

    // G to H
    const gInput = document.getElementById("g-date-input") as HTMLInputElement;
    const hResult = document.getElementById("h-result");
    const hResultDetails = document.getElementById("h-result-details");

    // H to G
    const hDaySelect = document.getElementById("h-day") as HTMLSelectElement;
    const hMonthSelect = document.getElementById(
        "h-month",
    ) as HTMLSelectElement;
    const hYearInput = document.getElementById("h-year") as HTMLInputElement;
    const convertHBtn = document.getElementById("convert-h-btn");
    const gResult = document.getElementById("g-result");
    const gResultDetails = document.getElementById("g-result-details");

    const hijriMonths = [
        "محرم",
        "صفر",
        "ربيع الأول",
        "ربيع الثاني",
        "جمادى الأولى",
        "جمادى الآخرة",
        "رجب",
        "شعبان",
        "رمضان",
        "شوال",
        "ذو القعدة",
        "ذو الحجة",
    ];

    // Initialize UI
    // Set G Input to today
    gInput.valueAsDate = new Date();

    // Fill H Day Select
    for (let i = 1; i <= 30; i++) {
        hDaySelect.add(new Option(i.toString(), i.toString()));
    }
    // Fill H Month Select
    hijriMonths.forEach((m, i) => {
        hMonthSelect.add(new Option(m, (i + 1).toString()));
    });
    // Set H Year default
    hYearInput.value = "1445";

    // Tabs Logic
    tabs.forEach((tab) => {
        tab.addEventListener("click", () => {
            tabs.forEach((t) => t.classList.remove("active"));
            contents.forEach((c) => c.classList.remove("active"));
            tab.classList.add("active");
            document.getElementById(tab.dataset.tab).classList.add("active");
        });
    });

    // Conversion Logic: G -> H
    function convertGtoH() {
        const date = new Date(gInput.value);
        if (isNaN(date.getTime())) return;

        const hijri = toHijri(
            date.getFullYear(),
            date.getMonth() + 1,
            date.getDate(),
        );

        hResult.textContent = `${hijri.hd} ${hijriMonths[hijri.hm - 1]} ${hijri.hy}`;
        hResultDetails.textContent = `الموافق للـ ${hijri.gd} (من الأيام) / ${hijri.hm} (من الشهور)`;
    }

    gInput.addEventListener("change", convertGtoH);
    // Initial Run
    convertGtoH();

    // Conversion Logic: H -> G
    function convertHtoG() {
        const d = parseInt(hDaySelect.value);
        const m = parseInt(hMonthSelect.value);
        const y = parseInt(hYearInput.value);

        if (!y) return;

        const greg = toGregorian(y, m, d);
        const date = new Date(greg.gy, greg.gm - 1, greg.gd);

        const options: Intl.DateTimeFormatOptions = {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
        };
        gResult.textContent = date.toLocaleDateString("ar-SA", options);
        // Note: 'ar-SA' usually defaults to Islamic calendar in some browsers, force greg context or use en-US then translate?
        // Actually toLocaleDateString('ar-EG') or just custom formatting is safer for "Gregorian in Arabic".
        // Let's use custom formatting to be safe.

        const gMonths = [
            "يناير",
            "فبراير",
            "مارس",
            "أبريل",
            "مايو",
            "يونيو",
            "يوليو",
            "أغسطس",
            "سبتمبر",
            "أكتوبر",
            "نوفمبر",
            "ديسمبر",
        ];
        gResult.textContent = `${greg.gd} ${gMonths[greg.gm - 1]} ${greg.gy}`;
    }

    convertHBtn.addEventListener("click", convertHtoG);
</script>

<style>
    .date-converter {
        max-width: 600px;
        margin: 0 auto;
    }

    .tabs {
        display: flex;
        gap: var(--space-xs);
        margin-bottom: var(--space-md);
        background: var(--c-border);
        padding: 4px;
        border-radius: var(--radius-md);
    }

    .tab-btn {
        flex: 1;
        padding: var(--space-sm);
        border: none;
        background: transparent;
        cursor: pointer;
        border-radius: var(--radius-sm);
        font-weight: 500;
        transition: background 0.2s;
    }

    .tab-btn.active {
        background: var(--c-surface);
        color: var(--c-primary);
        box-shadow: var(--shadow-sm);
    }

    .tab-content {
        display: none;
        animation: fadeIn 0.3s ease;
    }

    .tab-content.active {
        display: block;
    }

    .form-group {
        margin-bottom: var(--space-md);
    }

    .form-input,
    .form-select {
        width: 100%;
        padding: var(--space-sm);
        border: 1px solid var(--c-border);
        border-radius: var(--radius-md);
        font-size: 1.1rem;
    }

    .result-box {
        background: var(--c-background);
        padding: var(--space-md);
        border-radius: var(--radius-md);
        text-align: center;
        margin-top: var(--space-md);
        border: 1px dashed var(--c-border);
    }

    .result-value {
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--c-primary);
        margin-block: var(--space-xs);
    }

    .hijri-inputs {
        display: grid;
        grid-template-columns: 1fr 2fr 1fr;
        gap: var(--space-sm);
        margin-bottom: var(--space-md);
    }

    .btn-primary {
        width: 100%;
        padding: var(--space-sm);
        background: var(--c-primary);
        color: white;
        border: none;
        border-radius: var(--radius-md);
        font-size: 1.1rem;
        cursor: pointer;
    }

    .btn-primary:hover {
        background: var(--c-primary-hover);
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(5px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>

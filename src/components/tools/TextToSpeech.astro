---

---

<div class="tool-content">
    <div class="input-group">
        <label for="input-text">ÿßŸÑŸÜÿµ ŸÑŸÑŸÇÿ±ÿßÿ°ÿ©:</label>
        <textarea id="input-text" rows="5" placeholder="ÿ£ÿØÿÆŸÑ ÿßŸÑŸÜÿµ ŸáŸÜÿß..."
        ></textarea>
    </div>

    <div class="controls-row">
        <div class="select-wrapper">
            <label for="voice-select">ÿßŸÑÿµŸàÿ™:</label>
            <select id="voice-select"></select>
        </div>

        <div class="slider-wrapper">
            <label>ÿßŸÑÿ≥ÿ±ÿπÿ©:</label>
            <input
                type="range"
                id="rate"
                min="0.5"
                max="2"
                value="1"
                step="0.1"
            />
        </div>

        <div class="slider-wrapper">
            <label>ÿßŸÑÿ≠ÿØÿ©:</label>
            <input
                type="range"
                id="pitch"
                min="0.5"
                max="2"
                value="1"
                step="0.1"
            />
        </div>
    </div>

    <div class="action-buttons">
        <button id="speak" class="btn primary">Start Speaking üîä</button>
        <button id="stop" class="btn danger">Stop ‚èπÔ∏è</button>
    </div>
</div>

<script>
    const synth = window.speechSynthesis;
    const input = document.getElementById("input-text") as HTMLTextAreaElement;
    const voiceSelect = document.getElementById(
        "voice-select",
    ) as HTMLSelectElement;
    const rateInput = document.getElementById("rate") as HTMLInputElement;
    const pitchInput = document.getElementById("pitch") as HTMLInputElement;

    let voices: SpeechSynthesisVoice[] = [];

    function populateVoices() {
        voices = synth.getVoices();
        voiceSelect.innerHTML = "";

        // Sort to put Arabic first if available
        voices.sort(function (a, b) {
            if (a.lang.includes("ar") && !b.lang.includes("ar")) return -1;
            if (!a.lang.includes("ar") && b.lang.includes("ar")) return 1;
            return a.name.localeCompare(b.name);
        });

        voices.forEach((voice) => {
            const option = document.createElement("option");
            option.textContent = `${voice.name} (${voice.lang})`;
            option.setAttribute("data-lang", voice.lang);
            option.setAttribute("data-name", voice.name);
            voiceSelect.appendChild(option);
        });
    }

    populateVoices();
    if (speechSynthesis.onvoiceschanged !== undefined) {
        speechSynthesis.onvoiceschanged = populateVoices;
    }

    document.getElementById("speak")?.addEventListener("click", () => {
        if (synth.speaking) {
            console.error("speechSynthesis.speaking");
            return;
        }

        if (input.value !== "") {
            const utterThis = new SpeechSynthesisUtterance(input.value);
            const selectedOption =
                voiceSelect.selectedOptions[0].getAttribute("data-name");

            for (let i = 0; i < voices.length; i++) {
                if (voices[i].name === selectedOption) {
                    utterThis.voice = voices[i];
                    break;
                }
            }

            utterThis.rate = parseFloat(rateInput.value);
            utterThis.pitch = parseFloat(pitchInput.value);

            synth.speak(utterThis);
        }
    });

    document.getElementById("stop")?.addEventListener("click", () => {
        synth.cancel();
    });
</script>

<style>
    .tool-content {
        display: flex;
        flex-direction: column;
        gap: var(--space-md);
    }

    textarea {
        width: 100%;
        padding: var(--space-sm);
        border: 1px solid var(--c-border);
        border-radius: var(--radius-md);
        background: var(--c-background);
        color: var(--c-text-main);
    }

    .controls-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--space-md);
        background: var(--c-surface);
        padding: var(--space-md);
        border-radius: var(--radius-md);
        border: 1px solid var(--c-border);
    }

    .select-wrapper,
    .slider-wrapper {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    select {
        padding: 0.5rem;
        border-radius: var(--radius-sm);
        border: 1px solid var(--c-border);
        background: var(--c-background);
        color: var(--c-text-main);
    }

    .action-buttons {
        display: flex;
        gap: var(--space-md);
    }

    .btn {
        padding: var(--space-sm) var(--space-xl);
        border-radius: var(--radius-md);
        border: none;
        cursor: pointer;
        font-weight: bold;
        flex: 1;
    }

    .primary {
        background: var(--c-primary);
        color: white;
    }

    .danger {
        background: #ef4444;
        color: white;
    }
</style>

---

---

<div class="stopwatch">
    <div class="time-display" id="time-display">00:00:00.00</div>

    <div class="controls">
        <button id="start-btn" class="btn btn-start">بدء</button>
        <button id="stop-btn" class="btn btn-stop" disabled>إيقاف</button>
        <button id="reset-btn" class="btn btn-reset" disabled
            >إعادة تعيين</button
        >
        <button id="lap-btn" class="btn btn-lap" disabled>جولة</button>
    </div>

    <div id="laps-container" class="laps-container">
        <!-- limit to 5 recent laps for clean UI, or scrollable -->
    </div>
</div>

<script>
    let startTime = 0;
    let elapsedTime = 0;
    let timerInterval;

    const display = document.getElementById("time-display");
    const startBtn = document.getElementById("start-btn") as HTMLButtonElement;
    const stopBtn = document.getElementById("stop-btn") as HTMLButtonElement;
    const resetBtn = document.getElementById("reset-btn") as HTMLButtonElement;
    const lapBtn = document.getElementById("lap-btn") as HTMLButtonElement;
    const lapsContainer = document.getElementById("laps-container");

    function formatTime(ms) {
        const date = new Date(ms);
        const m = date.getUTCMinutes().toString().padStart(2, "0");
        const s = date.getUTCSeconds().toString().padStart(2, "0");
        const cs = Math.floor(date.getUTCMilliseconds() / 10)
            .toString()
            .padStart(2, "0");
        return `${m}:${s}.${cs}`;
    }

    // Extended format for hours if needed, but keeping simple typical stopwatch
    // Actually let's do HH:MM:SS.ms
    function formatTimeExtended(ms) {
        const h = Math.floor(ms / 3600000)
            .toString()
            .padStart(2, "0");
        const m = Math.floor((ms % 3600000) / 60000)
            .toString()
            .padStart(2, "0");
        const s = Math.floor((ms % 60000) / 1000)
            .toString()
            .padStart(2, "0");
        const cs = Math.floor((ms % 1000) / 10)
            .toString()
            .padStart(2, "0");
        return `${h}:${m}:${s}.${cs}`;
    }

    function update() {
        const now = Date.now();
        const time = elapsedTime + (now - startTime);
        display.textContent = formatTimeExtended(time);
        return time; // for lap
    }

    startBtn.addEventListener("click", () => {
        startTime = Date.now();
        timerInterval = setInterval(update, 10);
        startBtn.disabled = true;
        stopBtn.disabled = false;
        resetBtn.disabled = true;
        lapBtn.disabled = false;
    });

    stopBtn.addEventListener("click", () => {
        elapsedTime += Date.now() - startTime;
        clearInterval(timerInterval);
        startBtn.disabled = false;
        stopBtn.disabled = true;
        resetBtn.disabled = false;
        lapBtn.disabled = true;
    });

    resetBtn.addEventListener("click", () => {
        elapsedTime = 0;
        display.textContent = "00:00:00.00";
        lapsContainer.innerHTML = "";
        startBtn.disabled = false;
        stopBtn.disabled = true;
        resetBtn.disabled = true;
        lapBtn.disabled = true;
    });

    lapBtn.addEventListener("click", () => {
        const now = Date.now();
        const total = elapsedTime + (now - startTime);
        const div = document.createElement("div");
        div.className = "lap-item";
        div.innerHTML = `<span>J${lapsContainer.children.length + 1}</span> <span>${formatTimeExtended(total)}</span>`;
        lapsContainer.prepend(div);
    });
</script>

<style>
    .stopwatch {
        max-width: 400px;
        margin: 0 auto;
        text-align: center;
    }

    .time-display {
        font-family: monospace;
        font-size: 3rem;
        font-weight: bold;
        color: var(--c-text-main);
        background: var(--c-surface);
        padding: var(--space-md);
        border-radius: var(--radius-lg);
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
        margin-bottom: var(--space-lg);
        border: 1px solid var(--c-border);
    }

    .controls {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-sm);
        margin-bottom: var(--space-lg);
    }

    .btn {
        padding: var(--space-md);
        border: none;
        border-radius: var(--radius-md);
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.1s;
    }

    .btn:active {
        transform: scale(0.98);
    }
    .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .btn-start {
        background: #10b981;
        color: white;
    }
    .btn-stop {
        background: #ef4444;
        color: white;
    }
    .btn-reset {
        background: var(--c-text-muted);
        color: white;
    }
    .btn-lap {
        background: var(--c-primary);
        color: white;
    }

    .laps-container {
        max-height: 300px;
        overflow-y: auto;
        border-top: 1px solid var(--c-border);
    }

    .lap-item {
        display: flex;
        justify-content: space-between;
        padding: var(--space-sm);
        border-bottom: 1px solid var(--c-border);
        font-family: monospace;
        font-size: 1.1rem;
    }
</style>

---

---

<div class="img-tool">
    <div class="upload-area">
        <input type="file" id="upload" accept="image/*" />
    </div>

    <div class="controls" id="controls" style="display:none;">
        <div class="dims">
            <label>Width: <input type="number" id="w" /></label>
            <label>Height: <input type="number" id="h" /></label>
            <label
                ><input type="checkbox" id="ratio" checked /> Keep Aspect Ratio</label
            >
        </div>
        <button id="resize-btn" class="btn-primary">Resize & Download</button>
    </div>

    <img
        id="preview"
        style="max-width:100%; display:none; margin-top:1rem; border:1px solid var(--c-border);"
    />
</div>

<script>
    const upload = document.getElementById("upload") as HTMLInputElement;
    const preview = document.getElementById("preview") as HTMLImageElement;
    const controls = document.getElementById("controls");
    const wInput = document.getElementById("w") as HTMLInputElement;
    const hInput = document.getElementById("h") as HTMLInputElement;
    const ratioCb = document.getElementById("ratio") as HTMLInputElement;
    const resizeBtn = document.getElementById("resize-btn");

    let originalW = 0;
    let originalH = 0;

    upload.addEventListener("change", (e) => {
        const file = (e.target as HTMLInputElement).files[0];
        if (file) {
            const url = URL.createObjectURL(file);
            preview.src = url;
            preview.style.display = "block";
            preview.onload = () => {
                originalW = preview.naturalWidth;
                originalH = preview.naturalHeight;
                wInput.value = originalW.toString();
                hInput.value = originalH.toString();
                controls.style.display = "flex";
            };
        }
    });

    wInput.addEventListener("input", () => {
        if (ratioCb.checked && originalW) {
            const w = parseInt(wInput.value);
            hInput.value = Math.round(w * (originalH / originalW)).toString();
        }
    });

    hInput.addEventListener("input", () => {
        if (ratioCb.checked && originalH) {
            const h = parseInt(hInput.value);
            wInput.value = Math.round(h * (originalW / originalH)).toString();
        }
    });

    resizeBtn.addEventListener("click", () => {
        const canvas = document.createElement("canvas");
        canvas.width = parseInt(wInput.value);
        canvas.height = parseInt(hInput.value);
        const ctx = canvas.getContext("2d");
        ctx.drawImage(preview, 0, 0, canvas.width, canvas.height);

        const link = document.createElement("a");
        link.download = "resized-image.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
    });
</script>

<style>
    .img-tool {
        max-width: 600px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
    .upload-area {
        border: 2px dashed var(--c-border);
        padding: 2rem;
        text-align: center;
        border-radius: 8px;
    }
    .controls {
        flex-direction: column;
        gap: 1rem;
        background: var(--c-surface);
        padding: 1rem;
        border-radius: 8px;
    }
    .dims {
        display: flex;
        gap: 1rem;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
    }
    input[type="number"] {
        padding: 0.5rem;
        width: 100px;
        border: 1px solid var(--c-border);
        border-radius: 4px;
    }
    .btn-primary {
        padding: 0.8rem;
        background: var(--c-primary);
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }
</style>

---

---

<div class="pomodoro">
    <div class="timer-display" id="time">25:00</div>
    <div class="status-text" id="status">ÙˆÙ‚Øª Ø§Ù„ØªØ±ÙƒÙŠØ² ğŸ¯</div>

    <div class="controls">
        <button id="start" class="btn">Ø¨Ø¯Ø¡</button>
        <button id="pause" class="btn" disabled>Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª</button>
        <button id="reset" class="btn">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
    </div>

    <div class="settings">
        <div class="setting-group">
            <label>ÙˆÙ‚Øª Ø§Ù„Ø¹Ù…Ù„ (Ø¯Ù‚ÙŠÙ‚Ø©)</label>
            <input type="number" id="work-input" value="25" min="1" max="60" />
        </div>
        <div class="setting-group">
            <label>ÙˆÙ‚Øª Ø§Ù„Ø±Ø§Ø­Ø© (Ø¯Ù‚ÙŠÙ‚Ø©)</label>
            <input type="number" id="break-input" value="5" min="1" max="30" />
        </div>
    </div>
</div>

<script>
    let timerId = null;
    let isWork = true;
    let timeLeft = 25 * 60;

    const display = document.getElementById("time");
    const status = document.getElementById("status");
    const startBtn = document.getElementById("start") as HTMLButtonElement;
    const pauseBtn = document.getElementById("pause") as HTMLButtonElement;
    const workInput = document.getElementById("work-input") as HTMLInputElement;
    const breakInput = document.getElementById(
        "break-input",
    ) as HTMLInputElement;

    function format(sec) {
        const m = Math.floor(sec / 60)
            .toString()
            .padStart(2, "0");
        const s = (sec % 60).toString().padStart(2, "0");
        return `${m}:${s}`;
    }

    function notify(msg) {
        if (Notification.permission === "granted") {
            new Notification(msg);
        } else if (Notification.permission !== "denied") {
            Notification.requestPermission().then((permission) => {
                if (permission === "granted") new Notification(msg);
            });
        }
    }

    function updateTimeFromSettings() {
        if (timerId) return; // Don't update if running
        timeLeft =
            (isWork ? parseInt(workInput.value) : parseInt(breakInput.value)) *
            60;
        display.textContent = format(timeLeft);
    }

    function tick() {
        if (timeLeft > 0) {
            timeLeft--;
            display.textContent = format(timeLeft);
        } else {
            clearInterval(timerId);
            timerId = null;
            notify(
                isWork
                    ? "Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø§Ù„Ø¹Ù…Ù„! Ø®Ø° Ø§Ø³ØªØ±Ø§Ø­Ø© â˜•"
                    : "Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø§Ø³ØªØ±Ø§Ø­Ø©! Ø¹Ø¯ Ù„Ù„Ø¹Ù…Ù„ ğŸ’ª",
            );
            isWork = !isWork;
            updateTimeFromSettings(); // switch to next duration
            status.textContent = isWork ? "ÙˆÙ‚Øª Ø§Ù„ØªØ±ÙƒÙŠØ² ğŸ¯" : "ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ±Ø§Ø­Ø© â˜•";
            startBtn.disabled = false;
            pauseBtn.disabled = true;
        }
    }

    startBtn.addEventListener("click", () => {
        if (!timerId) {
            timerId = setInterval(tick, 1000);
            startBtn.disabled = true;
            pauseBtn.disabled = false;
            workInput.disabled = true;
            breakInput.disabled = true;
            Notification.requestPermission();
        }
    });

    pauseBtn.addEventListener("click", () => {
        clearInterval(timerId);
        timerId = null;
        startBtn.disabled = false;
        pauseBtn.disabled = true;
        workInput.disabled = false;
        breakInput.disabled = false;
    });

    document.getElementById("reset").addEventListener("click", () => {
        clearInterval(timerId);
        timerId = null;
        isWork = true;
        workInput.disabled = false;
        breakInput.disabled = false;
        updateTimeFromSettings();
        status.textContent = "ÙˆÙ‚Øª Ø§Ù„ØªØ±ÙƒÙŠØ² ğŸ¯";
        startBtn.disabled = false;
        pauseBtn.disabled = true;
    });

    workInput.addEventListener("change", updateTimeFromSettings);
    breakInput.addEventListener("change", updateTimeFromSettings);
</script>

<style>
    .pomodoro {
        max-width: 400px;
        margin: 0 auto;
        text-align: center;
    }
    .timer-display {
        font-size: 4rem;
        font-weight: bold;
        color: var(--c-primary);
        margin: 20px 0;
        font-family: monospace;
    }
    .status-text {
        font-size: 1.2rem;
        color: var(--c-text-muted);
        margin-bottom: 20px;
    }
    .controls {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-bottom: 30px;
    }
    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        background: var(--c-surface);
        border: 1px solid var(--c-border);
        cursor: pointer;
        font-size: 1rem;
    }
    .btn:hover {
        background: var(--c-background);
    }
    button:disabled {
        opacity: 0.5;
    }

    .settings {
        display: flex;
        gap: 20px;
        justify-content: center;
        padding-top: 20px;
        border-top: 1px solid var(--c-border);
    }
    .setting-group {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }
    input {
        padding: 8px;
        width: 70px;
        border-radius: 4px;
        border: 1px solid #ccc;
        text-align: center;
    }
</style>
